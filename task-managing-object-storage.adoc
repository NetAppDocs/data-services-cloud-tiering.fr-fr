---
sidebar: sidebar 
permalink: task-managing-object-storage.html 
keywords: object storage, mirror object storage, create object storage, remove object storage, swap object storage, display object storage, license 
summary: 'Une fois que vous avez configuré vos clusters ONTAP sur site pour hiérarchiser les données vers un stockage d"objets particulier, vous pouvez effectuer des tâches de stockage d"objets supplémentaires dans NetApp Cloud Tiering.  Vous pouvez ajouter un nouveau stockage d"objets, dupliquer vos données hiérarchisées sur un stockage d"objets secondaire, permuter le stockage d"objets principal et le stockage d"objets miroir, supprimer un stockage d"objets miroir d"un agrégat, et bien plus encore.' 
---
= Gérer le stockage objet utilisé pour la hiérarchisation des données dans NetApp Cloud Tiering
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Une fois que vous avez configuré vos clusters ONTAP sur site pour hiérarchiser les données vers un stockage d'objets particulier, vous pouvez effectuer des tâches de stockage d'objets supplémentaires à l'aide de NetApp Cloud Tiering.  Vous pouvez ajouter un nouveau stockage d'objets, dupliquer vos données hiérarchisées sur un stockage d'objets secondaire, permuter le stockage d'objets principal et le stockage d'objets miroir, supprimer un stockage d'objets miroir d'un agrégat, et bien plus encore.



== Afficher les magasins d'objets configurés pour un cluster

Vous pouvez consulter tous les magasins d'objets configurés pour chaque cluster et les agrégats auxquels ils sont rattachés.

.Étapes
. Depuis la page *Clusters*, sélectionnez l'icône de menu d'un cluster et sélectionnez *Informations sur le magasin d'objets*.
. Consultez les détails concernant les magasins d'objets.
+
Cet exemple montre à la fois un stockage d'objets Amazon S3 et un stockage d'objets Azure Blob connectés à différents agrégats sur un cluster.

+
image:screenshot_tiering_object_store_view.png["Une capture d'écran montrant les informations de stockage d'objets, détaillant la capacité totale utilisée, l'agrégat associé au stockage d'objets, le nom du stockage d'objets et d'autres informations."]





== Ajouter un nouveau magasin d'objets

Vous pouvez ajouter un nouveau stockage d'objets pour les agrégats dans votre cluster.  Une fois créé, vous pouvez l'associer à un agrégat.

.Étapes
. Depuis la page *Clusters*, sélectionnez l'icône de menu d'un cluster et sélectionnez *Informations sur le magasin d'objets*.
. Sur la page Informations sur le magasin d'objets, sélectionnez *Créer un nouveau magasin d'objets*.
+
image:screenshot_tiering_object_store_create_button.png["Capture d'écran montrant le bouton « Créer un nouveau magasin d'objets » permettant de créer un nouveau magasin d'objets."]

+
L'assistant de stockage d'objets démarre.  L'exemple ci-dessous montre comment créer un stockage d'objets dans Amazon S3.

. *Définir le nom du stockage d'objets* : Saisissez un nom pour ce stockage d'objets.  Il doit être unique par rapport à tout autre stockage d'objets que vous pourriez utiliser avec des agrégats sur ce cluster.
. *Sélectionnez le fournisseur* : Sélectionnez le fournisseur, par exemple *Amazon Web Services*, puis sélectionnez *Continuer*.
. Suivez les étapes décrites sur les pages *Créer un stockage d'objets* :
+
.. *Compartiment S3* : Ajoutez un nouveau compartiment S3 ou sélectionnez un compartiment S3 existant commençant par le préfixe _fabric-pool_.  Saisissez ensuite l'ID du compte AWS qui donne accès au compartiment, sélectionnez la région du compartiment, puis sélectionnez *Continuer*.
+
Le préfixe _fabric-pool_ est requis car la stratégie IAM de l'agent Console autorise l'instance à effectuer des actions S3 sur des compartiments nommés avec ce préfixe exact.  Par exemple, vous pourriez nommer le compartiment S3 _fabric-pool-AFF1_, où AFF1 est le nom du cluster.

.. *Cycle de vie des classes de stockage* : Cloud Tiering gère les transitions du cycle de vie de vos données hiérarchisées.  Les données sont initialement stockées dans la classe _Standard_, mais vous pouvez créer une règle pour appliquer une classe de stockage différente aux données après un certain nombre de jours.
+
Sélectionnez la classe de stockage S3 vers laquelle vous souhaitez transférer les données hiérarchisées et le nombre de jours avant que les données ne soient affectées à cette classe, puis sélectionnez *Continuer*.  Par exemple, la capture d'écran ci-dessous montre que les données hiérarchisées sont affectées à la classe _Standard-IA_ à partir de la classe _Standard_ après 45 jours de stockage d'objets.

+
Si vous choisissez *Conserver les données dans cette classe de stockage*, les données restent dans la classe de stockage _Standard_ et aucune règle n'est appliquée. link:reference-aws-support.html["Voir les classes de stockage prises en charge"^].

+
image:screenshot_tiering_lifecycle_selection_aws.png["Capture d'écran montrant comment sélectionner une autre classe de stockage qui sera attribuée à vos données après un certain nombre de jours."]

+
Notez que la règle de cycle de vie s'applique à tous les objets du compartiment sélectionné.

.. *Identifiants* : Saisissez l’ID de clé d’accès et la clé secrète d’un utilisateur IAM disposant des autorisations S3 requises, puis sélectionnez *Continuer*.
+
L'utilisateur IAM doit appartenir au même compte AWS que le compartiment que vous avez sélectionné ou créé sur la page *Compartiment S3*.  Consultez les autorisations requises dans la section relative à l'activation de la hiérarchisation.

.. *Réseau de cluster* : Sélectionnez l’espace IP ONTAP doit utiliser pour se connecter au stockage d’objets, puis sélectionnez *Continuer*.
+
Le choix de l'espace IP approprié garantit que Cloud Tiering peut établir une connexion entre ONTAP et le stockage d'objets de votre fournisseur de cloud.





Le magasin d'objets est créé.

Vous pouvez désormais connecter le magasin d'objets à un agrégat de votre cluster.



== Ajoutez un deuxième magasin d'objets à un agrégat pour la mise en miroir.

Vous pouvez connecter un deuxième magasin d'objets à un agrégat pour créer un miroir FabricPool afin de répartir les données de manière synchrone entre deux magasins d'objets.  Vous devez avoir un magasin d'objets déjà connecté à l'agrégat. https://docs.netapp.com/us-en/ontap/fabricpool/create-mirror-task.html["Découvrez-en plus sur les miroirs FabricPool"^] .

Lorsque vous utilisez une configuration MetroCluster , il est recommandé d'utiliser des stockages d'objets dans le cloud public situés dans des zones de disponibilité différentes. https://docs.netapp.com/us-en/ontap/fabricpool/setup-object-stores-mcc-task.html["Pour en savoir plus sur les exigences de MetroCluster , consultez la documentation ONTAP ."^] .  Au sein d'un MetroCluster, il est déconseillé d'utiliser des agrégats non mis en miroir, car cela générera un message d'erreur.

Lorsque vous utilisez StorageGRID comme système de stockage d'objets dans une configuration MetroCluster , les deux systèmes ONTAP peuvent effectuer une hiérarchisation FabricPool vers un seul système StorageGRID .  Chaque système ONTAP doit répartir les données dans différents compartiments.

.Étapes
. Sur la page *Clusters*, sélectionnez *Configuration avancée* pour le cluster sélectionné.
+
image:screenshot_tiering_advanced_setup_button.png["Capture d'écran montrant le bouton Configuration avancée d'un cluster."]

. Depuis la page Configuration avancée, faites glisser le magasin d'objets que vous souhaitez utiliser vers l'emplacement du magasin d'objets miroir.
+
image:screenshot_tiering_mirror_config.png["Capture d'écran montrant comment faire glisser un deuxième magasin d'objets vers un agrégat pour créer un miroir hiérarchisé."]

. Dans la boîte de dialogue Attacher un magasin d'objets, sélectionnez *Attacher* et le deuxième magasin d'objets est attaché à l'agrégat.
+
image:screenshot_tiering_mirror_config_complete.png["Capture d'écran montrant un deuxième magasin d'objets rattaché à un agrégat."]



L'état du miroir affichera « Synchronisation en cours » pendant la synchronisation des deux magasins d'objets.  Le statut passera à « Synchronisé » une fois la synchronisation terminée.



== Échangez le magasin d'objets principal et le magasin d'objets miroir

Vous pouvez remplacer le magasin d'objets principal et le magasin d'objets miroir par un agrégat.  Le miroir du magasin d'objets devient le miroir primaire, et le miroir primaire d'origine devient le miroir.

.Étapes
. Sur la page *Clusters*, sélectionnez *Configuration avancée* pour le cluster sélectionné.
+
image:screenshot_tiering_advanced_setup_button.png["Capture d'écran montrant le bouton Configuration avancée d'un cluster."]

. Depuis la page Configuration avancée, sélectionnez l'icône de menu de l'agrégat et sélectionnez *Inverser les destinations*.
+
image:screenshot_tiering_mirror_swap.png["Capture d'écran montrant l'option Destination d'échange pour un agrégat."]

. Approuvez l'action dans la boîte de dialogue et les magasins d'objets principal et miroir seront échangés.




== Supprimer un magasin d'objets miroir d'un agrégat

Vous pouvez supprimer un miroir FabricPool si vous n'avez plus besoin de répliquer vers un stockage d'objets supplémentaire.

.Étapes
. Sur la page *Clusters*, sélectionnez *Configuration avancée* pour le cluster sélectionné.
+
image:screenshot_tiering_advanced_setup_button.png["Capture d'écran montrant le bouton Configuration avancée d'un cluster."]

. Sur la page Configuration avancée, sélectionnez l'icône de menu de l'agrégat et sélectionnez *Désupprimer le magasin d'objets*.
+
image:screenshot_tiering_mirror_delete.png["Capture d'écran montrant l'option « Unmirror Object Store » pour un agrégat."]



Le magasin d'objets miroir est supprimé de l'agrégat et les données hiérarchisées ne sont plus répliquées.


NOTE: Lorsque vous supprimez le magasin d'objets miroir d'une configuration MetroCluster , un message vous demandera si vous souhaitez également supprimer le magasin d'objets principal.  Vous pouvez choisir de conserver le magasin d'objets principal associé à l'agrégat, ou de le supprimer.



== Migrez vos données hiérarchisées vers un autre fournisseur de cloud.

Le Cloud Tiering vous permet de migrer facilement vos données hiérarchisées vers un autre fournisseur de cloud.  Par exemple, si vous souhaitez migrer d'Amazon S3 vers Azure Blob, vous pouvez suivre les étapes ci-dessus dans cet ordre :

. Ajouter un stockage d'objets Blob Azure.
. Attachez ce nouveau magasin d'objets comme miroir de l'agrégat existant.
. Inverser les magasins d'objets principal et miroir.
. Supprimez la mise en miroir du stockage d'objets Amazon S3.

