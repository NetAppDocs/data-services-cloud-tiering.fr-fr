---
sidebar: sidebar 
permalink: task-tiering-onprem-s3-compat.html 
keywords: data tiering, fabricpool, cloud tiering, tiering cold data, tiering inactive data, tiering aff, tiering fas, tiering ontap, tiering volumes, tier data, tier cold data, tier fas, tier aff, tier ontap, s3, tier to s3, minio 
summary: 'Libérez de l"espace sur vos clusters ONTAP sur site en hiérarchisant les données inactives vers n"importe quel service de stockage d"objets utilisant le protocole Simple Storage Service (S3).' 
---
= Tierisation des données des clusters ONTAP sur site vers le stockage d'objets S3 dans NetApp Cloud Tiering
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Libérez de l'espace sur vos clusters ONTAP sur site en hiérarchisant les données inactives dans NetApp Cloud Tiering vers n'importe quel service de stockage d'objets utilisant le protocole Simple Storage Service (S3).

À ce jour, le stockage d'objets MinIO a été qualifié.

[CAUTION]
====
Les clients qui souhaitent utiliser des stockages d'objets qui ne sont pas officiellement pris en charge en tant que niveau cloud peuvent le faire en suivant ces instructions.  Les clients doivent tester et confirmer que le système de stockage d'objets répond à leurs exigences.

NetApp n'offre aucun support et n'est pas responsable des problèmes découlant d'un service de stockage d'objets tiers, en particulier lorsqu'elle n'a pas conclu d'accord de support avec le tiers ayant fourni le produit.  Il est convenu que NetApp ne sera pas responsable des dommages associés et ne sera pas tenu de fournir une assistance concernant ce produit tiers.

====


== Démarrage rapide

Commencez rapidement en suivant ces étapes ou faites défiler les sections restantes pour obtenir tous les détails.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-1.png["Un"]Préparez-vous à hiérarchiser les données vers un stockage d'objets compatible S3
[role="quick-margin-para"]
Vous avez besoin des éléments suivants :

[role="quick-margin-list"]
* Un cluster ONTAP source sur site exécutant ONTAP 9.8 ou une version ultérieure que vous avez ajouté à la NetApp Console, et une connexion via un port spécifié par l'utilisateur vers le stockage d'objets de destination compatible S3. https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Apprenez à découvrir un cluster"^] .
* Le nom de domaine complet (FQDN), la clé d'accès et la clé secrète du serveur de stockage d'objets afin que le cluster ONTAP puisse accéder au compartiment.
* Un agent Console installé sur vos locaux.
* Mise en réseau pour l'agent qui permet une connexion HTTPS sortante vers le cluster ONTAP source, vers le stockage d'objets compatible S3 et vers le service Cloud Tiering.


.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-2.png["Deux"]Mettre en place une hiérarchisation
[role="quick-margin-para"]
Dans la console, sélectionnez un système sur site, sélectionnez *Activer* pour le service de hiérarchisation et suivez les instructions pour hiérarchiser les données vers un stockage d'objets compatible S3.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-3.png["Trois"]Mise en place de la licence
[role="quick-margin-para"]
Payez votre service de hiérarchisation cloud via un abonnement à la carte auprès de votre fournisseur de cloud, une licence cloud personnalisée (apportez votre propre licence) ou une combinaison des deux :

[role="quick-margin-list"]
* Pour souscrire à l'offre PAYGO de https://aws.amazon.com/marketplace/pp/prodview-oorxakq6lq7m4?sr=0-8&ref_=beagle&applicationId=AWSMPContessa["Place de marché AWS"^] , https://azuremarketplace.microsoft.com/en-us/marketplace/apps/netapp.cloud-manager?tab=Overview["Place de marché Azure"^] , ou https://console.cloud.google.com/marketplace/details/netapp-cloudmanager/cloud-manager?supportedpurview=project&rif_reserved["Place de marché GCP"^] Sélectionnez *S'abonner* et suivez les instructions.
* Pour payer avec une licence BYOL Cloud Tiering, envoyez un e-mail à ng-cloud-tiering@netapp.com?subject=Licensing[contactez-nous si vous devez en acheter une], puislink:https://docs.netapp.com/us-en/bluexp-digital-wallet/task-manage-data-services-licenses.html["ajoutez-le à la NetApp Console"^] . .




== Exigences

Vérifiez la compatibilité avec votre cluster ONTAP , configurez votre réseau et préparez votre stockage d'objets.

L'image suivante montre chaque composant et les connexions que vous devez préparer entre eux :

image:diagram_cloud_tiering_s3_compat.png["Une image d'architecture montrant le service Cloud Tiering avec une connexion à l'agent sur vos locaux, l'agent avec une connexion à votre cluster ONTAP et une connexion entre le cluster ONTAP et le stockage d'objets.  Les données actives résident sur le cluster ONTAP , tandis que les données inactives résident dans le stockage objet."]


NOTE: La communication entre l'agent et le serveur de stockage d'objets compatible S3 est réservée à la configuration du stockage d'objets.



=== Préparez vos clusters ONTAP

Vos clusters ONTAP sources doivent répondre aux exigences suivantes lors du transfert de données vers un stockage d'objets compatible S3.

Plateformes ONTAP prises en charge:: Vous pouvez hiérarchiser les données provenant de systèmes AFF ou de systèmes FAS avec des agrégats entièrement SSD ou des agrégats entièrement HDD.
Version ONTAP prise en charge:: ONTAP 9.8 ou version ultérieure
exigences de mise en réseau du cluster::
+
--
* Le cluster ONTAP initie une connexion HTTPS via un port spécifié par l'utilisateur vers un stockage d'objets compatible S3 (le port est configurable lors de la configuration de la hiérarchisation).
+
Le système ONTAP source lit et écrit des données depuis et vers le stockage d'objets. Le stockage d'objets ne s'initialise jamais, il répond simplement.

* Une connexion entrante est requise de la part de l'agent, qui doit se trouver dans vos locaux.
+
Aucune connexion n'est requise entre le cluster et le service Cloud Tiering.

* Une interface LIF inter-cluster est requise sur chaque nœud ONTAP hébergeant les volumes que vous souhaitez hiérarchiser.  L'interface LIF doit être associée à l'espace IP que ONTAP doit utiliser pour se connecter au stockage d'objets.
+
Lorsque vous configurez la hiérarchisation des données, Cloud Tiering vous invite à indiquer l'espace IP à utiliser. Vous devez choisir l’espace IP auquel chaque LIF est associé. Il peut s'agir de l'espace IP « par défaut » ou d'un espace IP personnalisé que vous avez créé.  Apprenez-en davantage sur https://docs.netapp.com/us-en/ontap/networking/create_a_lif.html["Les LIF"^] et https://docs.netapp.com/us-en/ontap/networking/standard_properties_of_ipspaces.html["Espaces IP"^] .



--
Volumes et agrégats pris en charge:: Le nombre total de volumes que Cloud Tiering peut hiérarchiser peut être inférieur au nombre de volumes présents sur votre système ONTAP .  C'est parce que les volumes ne peuvent pas être hiérarchisés à partir de certains agrégats.  Consultez la documentation ONTAP pour https://docs.netapp.com/us-en/ontap/fabricpool/requirements-concept.html#functionality-or-features-not-supported-by-fabricpool["fonctionnalités ou caractéristiques non prises en charge par FabricPool"^] .



TIP: La hiérarchisation cloud prend en charge les volumes FlexVol et FlexGroup .



=== Découvrez un cluster ONTAP

Vous devez ajouter votre système ONTAP local à la console avant de pouvoir commencer la hiérarchisation des données froides.

https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Apprenez à découvrir un cluster"^].



=== Préparer un stockage d'objets compatible S3

Le stockage d'objets compatible S3 doit répondre aux exigences suivantes.

[[preparing-s3-compatible-object-storage]]
Informations d'identification S3:: Lorsque vous configurez la hiérarchisation vers un stockage d'objets compatible S3, vous êtes invité à créer un compartiment S3 ou à sélectionner un compartiment S3 existant.  Vous devez fournir à Cloud Tiering une clé d'accès S3 et une clé secrète.  Cloud Tiering utilise les clés pour accéder à votre compartiment.
+
--
Ces clés d’accès doivent être associées à un utilisateur disposant des autorisations suivantes :

[source, json]
----
"s3:ListAllMyBuckets",
"s3:ListBucket",
"s3:GetObject",
"s3:PutObject",
"s3:DeleteObject",
"s3:CreateBucket"
----
--




=== Créer ou changer d'agent

Un agent Console est nécessaire pour transférer les données vers le cloud.  Lors du transfert de données vers un stockage d'objets compatible S3, un agent doit être disponible sur vos locaux.  Vous devrez soit installer un nouvel agent, soit vous assurer que l'agent actuellement sélectionné se trouve sur site.

* https://docs.netapp.com/us-en/bluexp-setup-admin/concept-connectors.html["Découvrez les agents"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-install-connector-on-prem.html["Installer et configurer un agent sur site"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-manage-multiple-connectors.html#switch-between-connectors["Changer d'agent"^]




=== Préparer la mise en réseau pour l'agent de la console

Assurez-vous que l'agent dispose des connexions réseau requises.

.Étapes
. Assurez-vous que le réseau sur lequel l'agent est installé autorise les connexions suivantes :
+
** Une connexion HTTPS via le port 443 au service Cloud Tiering(https://docs.netapp.com/us-en/bluexp-setup-admin/task-set-up-networking-on-prem.html#endpoints-contacted-for-day-to-day-operations["voir la liste des points de terminaison"^] )
** Une connexion HTTPS via le port 443 vers un stockage d'objets compatible S3
** Une connexion HTTPS via le port 443 vers votre LIF de gestion de cluster ONTAP






== Mise à niveau des données inactives de votre premier cluster vers un stockage d'objets compatible S3

Une fois votre environnement préparé, commencez à hiérarchiser les données inactives de votre premier cluster.

.Ce dont vous aurez besoin
* https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Un système sur site a été ajouté à la NetApp Console."^].
* Le nom de domaine complet (FQDN) du serveur de stockage d'objets compatible S3 et le port qui sera utilisé pour les communications HTTPS.
* Une clé d'accès et une clé secrète disposant des autorisations S3 requises.


.Étapes
. Sélectionnez le système ONTAP sur site.
. Cliquez sur *Activer* pour le service de hiérarchisation cloud dans le panneau de droite.
+
image:screenshot_setup_tiering_onprem.png["Capture d'écran montrant l'option de hiérarchisation qui apparaît sur le côté droit de l'écran après avoir sélectionné un système ONTAP sur site."]

. *Définir le nom du stockage d'objets* : Saisissez un nom pour ce stockage d'objets.  Il doit être unique par rapport à tout autre stockage d'objets que vous pourriez utiliser avec des agrégats sur ce cluster.
. *Sélectionnez le fournisseur* : Sélectionnez *Compatible S3* et sélectionnez *Continuer*.
. Suivez les étapes décrites sur les pages *Créer un stockage d'objets* :
+
.. *Serveur* : Saisissez le nom de domaine complet (FQDN) du serveur de stockage d’objets compatible S3, le port ONTAP doit utiliser pour la communication HTTPS avec le serveur, ainsi que la clé d’accès et la clé secrète d’un compte disposant des autorisations S3 requises.
.. *Bucket* : Ajoutez un nouveau bucket ou sélectionnez un bucket existant et sélectionnez *Continuer*.
.. *Réseau de cluster* : Sélectionnez l’espace IP ONTAP doit utiliser pour se connecter au stockage d’objets et sélectionnez *Continuer*.
+
Le choix de l'espace IP approprié garantit que Cloud Tiering peut établir une connexion entre ONTAP et votre stockage d'objets compatible S3.

+
Vous pouvez également définir la bande passante réseau disponible pour le transfert des données inactives vers le stockage d'objets en définissant le « débit de transfert maximal ». Sélectionnez le bouton radio *Limité* et entrez la bande passante maximale pouvant être utilisée, ou sélectionnez *Illimité* pour indiquer qu'il n'y a pas de limite.



. Sur la page de confirmation, sélectionnez *Continuer* pour configurer vos volumes maintenant.
. Sur la page _Tier Volumes_, sélectionnez les volumes pour lesquels vous souhaitez configurer la hiérarchisation et sélectionnez *Continuer* :
+
** Pour sélectionner tous les volumes, cochez la case dans la ligne du titre (image:button_backup_all_volumes.png[""] ) et sélectionnez *Configurer les volumes*.
** Pour sélectionner plusieurs volumes, cochez la case correspondant à chaque volume (image:button_backup_1_volume.png[""] ) et sélectionnez *Configurer les volumes*.
** Pour sélectionner un seul volume, sélectionnez la ligne (ouimage:screenshot_edit_icon.gif["icône de modification du crayon"] icône) pour le volume.
+
image:screenshot_tiering_initial_volumes.png["Une capture d'écran montrant comment sélectionner un seul volume, plusieurs volumes ou tous les volumes, ainsi que le bouton « Modifier les volumes sélectionnés »."]



. Dans la boîte de dialogue _Stratégie de hiérarchisation_, sélectionnez une stratégie de hiérarchisation, ajustez éventuellement les jours de refroidissement pour les volumes sélectionnés, puis sélectionnez *Appliquer*.
+
link:concept-cloud-tiering.html#volume-tiering-policies["Apprenez-en davantage sur les politiques de tarification par paliers et les jours de refroidissement."].

+
image:screenshot_tiering_initial_policy_settings.png["Capture d'écran montrant les paramètres configurables de la politique de hiérarchisation."]



.Quelle est la prochaine étape ?
link:task-licensing-cloud-tiering.html["Assurez-vous de vous abonner au service Cloud Tiering"].

Vous pouvez consulter les informations relatives aux données actives et inactives du cluster. link:task-managing-tiering.html["Apprenez-en davantage sur la gestion de vos paramètres de hiérarchisation"].

Vous pouvez également créer un stockage d'objets supplémentaire dans les cas où vous souhaiteriez hiérarchiser les données de certains agrégats d'un cluster vers différents stockages d'objets.  Ou si vous prévoyez d'utiliser FabricPool Mirroring, où vos données hiérarchisées sont répliquées sur un stockage d'objets supplémentaire. link:task-managing-object-storage.html["Apprenez-en davantage sur la gestion des magasins d'objets"].
